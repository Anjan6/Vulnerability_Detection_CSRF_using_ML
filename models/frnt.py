import pandas as pd
import joblib
import streamlit as st

# Load the saved model
model = joblib.load('D://models//random_forest_model8754.pkl')

# Load the training columns
training_columns = joblib.load("D://models//training_columns.pkl")

# Select the columns for user input
input_columns = ['column1', 'column2', 'column3', 'column4', 'column5']

# Create a function to preprocess user input
def preprocess_input(user_input):
    # Create a DataFrame from the user input
    input_data = pd.DataFrame([user_input])

    # One-hot encode the user input
    input_encoded = pd.get_dummies(input_data)

    # Reorder the columns to match the training data
    input_encoded = input_encoded.reindex(columns=training_columns, fill_value=0)

    return input_encoded

# Create a function to make predictions
def predict(input_data):
    # Preprocess the input
    input_encoded = preprocess_input(input_data)

    # Make predictions
    prediction = model.predict(input_encoded)

    return prediction

# Create the Streamlit app
def main():
    st.title("Anomaly Detection")
    
    # Create input fields for user input
    input_data = {}
    for column in input_columns:
        input_data[column] = st.text_input(column)
    
    # Check if the user has entered all the required inputs
    if all(value != '' for value in input_data.values()):
        # Make predictions
        prediction = predict(input_data)
        
        # Display the prediction
        st.write("Prediction:", prediction)
    else:
        st.write("Please enter all the required inputs.")

if __name__ == '__main__':
    main()
